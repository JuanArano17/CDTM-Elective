{% extends 'base.html' %}
{% block content %}
<h2>{{ t('dashboard') }}</h2>
<div class="row">
  <div class="col-md-6">
    <h4>{{ t('recent_workouts') }}</h4>
    <ul class="list-group">
      {% for w in data['gym_workouts']|sort(attribute='date', reverse=true)[:5] %}
      <li class="list-group-item">
        {{ w['date'] }}: {{ w['notes'] }} ({{ t('duration_minutes') }}: {{ w['duration'] }})
      </li>
      {% else %}
      <li class="list-group-item">{{ t('no_workouts') }}</li>
      {% endfor %}
    </ul>
  </div>
  <div class="col-md-6">
    <h4>{{ t('weight_progress') }}</h4>
    <canvas id="weightChart"></canvas>
  </div>
</div>
<div class="row mt-4">
  <div class="col-md-6">
    <h4>{{ t('running') }}</h4>
    <canvas id="runChart"></canvas>
  </div>
  <div class="col-md-6">
    <h4>{{ t('diet_program') }}</h4>
    <canvas id="dietChart"></canvas>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Weight Chart
const weightData = {
  labels: {{ data['weight_tracking']|map(attribute='date')|list|tojson }},
  datasets: [{
    label: '{{ t('body_weight') }}',
    data: {{ data['weight_tracking']|map(attribute='weight')|list|tojson }},
    borderColor: 'blue',
    fill: false
  }]
};
new Chart(document.getElementById('weightChart'), {type: 'line', data: weightData});
// Running Chart
const runData = {
  labels: {{ data['running_logs']|map(attribute='date')|list|tojson }},
  datasets: [{
    label: '{{ t('distance') }}',
    data: {{ data['running_logs']|map(attribute='distance')|list|tojson }},
    borderColor: 'green',
    fill: false
  }]
};
new Chart(document.getElementById('runChart'), {type: 'line', data: runData});
// Diet Chart
const dietData = {
  labels: {{ data['diet_program']|map(attribute='date')|list|tojson }},
  datasets: [{
    label: '{{ t('calories') }}',
    data: {{ data['diet_program']|map(attribute='calories')|list|tojson }},
    borderColor: 'orange',
    fill: false
  }]
};
new Chart(document.getElementById('dietChart'), {type: 'line', data: dietData});
</script>
{% endblock %} 